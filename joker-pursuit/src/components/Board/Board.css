.board-container {
  width: 100%;
  height: 100%;
  display: flex;
  justify-content: center;
  align-items: center;
  overflow: hidden;
  position: relative;
  cursor: grab;
  user-select: none;
  -webkit-user-select: none;
  touch-action: none;
  z-index: 1;
}

.board-container.dragging {
  cursor: grabbing;
}

.board-container.selecting {
  cursor: pointer;
}

.board {
  position: absolute;
  left: 50%;
  top: 50%;
  width: 1400px;
  height: 1400px;
  transform: translate(-50%, -50%);
  transform-origin: center;
  display: flex;
  justify-content: center;
  align-items: center;
  background: transparent;
  overflow: visible;
  z-index: 2;
  transition: transform 0.1s ease;
  will-change: transform;
}

.board-background-circle {
  position: absolute;
  border-radius: 50%;
  z-index: 1;
  background:
    radial-gradient(circle at 50% 35%, #fdfefe 0%, #f1f6fb 52%, #e6edf4 100%);
  border: 2px solid rgba(168, 187, 209, 0.65);
  box-shadow:
    0 22px 40px rgba(8, 15, 23, 0.24),
    inset 0 2px 8px rgba(255, 255, 255, 0.95);
  pointer-events: none;
}

.board::before {
  content: '';
  position: absolute;
  inset: 86px;
  border-radius: 50%;
  border: 1px dashed rgba(76, 102, 131, 0.22);
  pointer-events: none;
  z-index: 1;
}

.board-section {
  position: relative;
  width: 100%;
  height: 100%;
}

.board-space {
  position: absolute;
  width: 24px;
  height: 24px;
  transform: translate(-50%, -50%);
  border-radius: 50%;
  display: flex;
  justify-content: center;
  align-items: center;
  border: 2px solid rgba(236, 244, 251, 0.85);
  box-shadow: 0 3px 7px rgba(8, 17, 27, 0.36);
  transition: transform 160ms ease, box-shadow 160ms ease, filter 160ms ease;
  z-index: 3;
}

.board-space:hover {
  transform: translate(-50%, -50%) scale(1.1);
  box-shadow: 0 5px 12px rgba(8, 17, 27, 0.46);
}

.space-normal {
  background: linear-gradient(145deg, #294760 0%, #1d3348 100%);
}

.space-normal:hover {
  filter: brightness(1.08);
}

.space-starting {
  display: none;
}

.space-corner {
  background: linear-gradient(145deg, #9d7529 0%, #7a591e 100%);
}

.space-castle {
  background: linear-gradient(145deg, #3f9968 0%, #2c7a51 100%);
}

.space-home {
  background: linear-gradient(145deg, #357ab3 0%, #285f8c 100%);
}

.space-entrance {
  background: linear-gradient(145deg, #c57338 0%, #9f5626 100%);
}

.space-connector {
  background: linear-gradient(145deg, #8e6530 0%, #694923 100%);
}

.board-space.selectable,
.selectable {
  animation: space-pulse 1.35s infinite;
  box-shadow:
    0 0 0 5px rgba(255, 193, 112, 0.65),
    0 0 20px rgba(255, 193, 112, 0.58);
  z-index: 6;
}

.board-space.recent-move-from {
  box-shadow:
    0 0 0 4px rgba(129, 199, 255, 0.58),
    0 0 18px rgba(129, 199, 255, 0.48);
}

.board-space.recent-move-to {
  animation: destination-pop 700ms ease-out;
  box-shadow:
    0 0 0 6px rgba(255, 205, 128, 0.55),
    0 0 20px rgba(255, 205, 128, 0.46);
}

.peg-move-overlay {
  position: absolute;
  inset: 0;
  pointer-events: none;
  z-index: 40;
}

.peg-move-trail {
  position: absolute;
  height: 4px;
  transform-origin: 0 50%;
  border-radius: 999px;
  background: linear-gradient(
    90deg,
    rgba(255, 255, 255, 0),
    var(--trail-color),
    rgba(255, 255, 255, 0)
  );
  box-shadow: 0 0 10px color-mix(in srgb, var(--trail-color) 52%, transparent);
  animation: trail-fade 1s ease forwards;
}

.peg-move-ghost {
  position: absolute;
  width: 18px;
  height: 18px;
  margin-left: -9px;
  margin-top: -9px;
  border-radius: 50%;
  border: 2px solid rgba(248, 253, 255, 0.95);
  background: var(--peg-color);
  box-shadow:
    0 4px 12px rgba(5, 11, 18, 0.48),
    0 0 0 2px color-mix(in srgb, var(--peg-color) 55%, transparent);
  animation: ghost-travel 1s cubic-bezier(0.22, 0.78, 0.24, 1) forwards;
}

.peg-move-ripple {
  position: absolute;
  width: 22px;
  height: 22px;
  margin-left: -11px;
  margin-top: -11px;
  border-radius: 50%;
  border: 2px solid color-mix(in srgb, var(--trail-color) 72%, #fff);
  animation: ripple-pulse 1s ease forwards;
}

.peg-move-ripple.end {
  animation-delay: 220ms;
}

.peg.selectable {
  animation: peg-pulse 1.2s infinite;
  box-shadow:
    0 0 0 3px rgba(255, 220, 167, 0.88),
    0 0 16px rgba(255, 220, 167, 0.56);
}

.peg.in-selectable-space {
  border-color: rgba(255, 242, 218, 0.95);
}

@keyframes space-pulse {
  0% {
    box-shadow:
      0 0 0 0 rgba(255, 193, 112, 0.62),
      0 0 8px rgba(255, 193, 112, 0.36);
  }
  70% {
    box-shadow:
      0 0 0 14px rgba(255, 193, 112, 0),
      0 0 14px rgba(255, 193, 112, 0.18);
  }
  100% {
    box-shadow:
      0 0 0 0 rgba(255, 193, 112, 0),
      0 0 8px rgba(255, 193, 112, 0.36);
  }
}

@keyframes peg-pulse {
  0% {
    transform: scale(1);
  }
  50% {
    transform: scale(1.09);
  }
  100% {
    transform: scale(1);
  }
}

@keyframes destination-pop {
  0% {
    transform: translate(-50%, -50%) scale(1);
  }
  45% {
    transform: translate(-50%, -50%) scale(1.2);
  }
  100% {
    transform: translate(-50%, -50%) scale(1);
  }
}

@keyframes trail-fade {
  0% {
    opacity: 0;
  }
  20% {
    opacity: 1;
  }
  100% {
    opacity: 0;
  }
}

@keyframes ghost-travel {
  0% {
    transform: translate(0, 0) scale(0.88);
    opacity: 0;
  }
  12% {
    opacity: 0.95;
  }
  85% {
    opacity: 0.85;
  }
  100% {
    transform: translate(var(--move-x), var(--move-y)) scale(0.68);
    opacity: 0;
  }
}

@keyframes ripple-pulse {
  0% {
    transform: scale(0.5);
    opacity: 0.9;
  }
  100% {
    transform: scale(3);
    opacity: 0;
  }
}

.selected {
  border-color: #77b8ff;
  box-shadow: 0 0 0 4px rgba(119, 184, 255, 0.5), 0 0 12px rgba(119, 184, 255, 0.75);
}

.peg {
  position: absolute;
  width: 18px;
  height: 18px;
  margin: 2px;
  border-radius: 50%;
  border: 2px solid rgba(242, 248, 253, 0.95);
  box-shadow:
    0 3px 7px rgba(6, 12, 19, 0.42),
    inset 0 1px 2px rgba(255, 255, 255, 0.4);
  transition: transform 170ms ease, box-shadow 170ms ease, left 420ms cubic-bezier(0.4, 0, 0.2, 1), top 420ms cubic-bezier(0.4, 0, 0.2, 1);
  z-index: 10;
}

.peg.selected {
  transform: scale(1.22);
  box-shadow:
    0 0 0 4px rgba(141, 206, 255, 0.6),
    0 0 18px rgba(141, 206, 255, 0.6);
  z-index: 28;
}

.space-label {
  position: absolute;
  bottom: -16px;
  font-size: 0.68rem;
  color: rgba(35, 57, 82, 0.68);
  white-space: nowrap;
  pointer-events: none;
}

.players-3 .space-label,
.players-4 .space-label,
.players-5 .space-label,
.players-6 .space-label,
.players-7 .space-label,
.players-8 .space-label {
  display: none;
}

.section-label {
  position: absolute;
  transform: translate(-50%, -50%);
  font-size: 1.1rem;
  font-weight: 700;
  color: rgba(18, 39, 59, 0.82);
  text-shadow: 0 2px 4px rgba(255, 255, 255, 0.64);
  pointer-events: none;
  z-index: 5;
}

.board-space.players-3 {
  width: 24px;
  height: 24px;
}

.board-space.players-4 {
  width: 16px;
  height: 16px;
}

.board-space.players-5 {
  width: 12px;
  height: 12px;
}

.board-space.players-6,
.board-space.players-7,
.board-space.players-8 {
  width: 10px;
  height: 10px;
}

.players-3 .peg {
  width: 14px;
  height: 14px;
}

.players-4 .peg {
  width: 12px;
  height: 12px;
}

.players-5 .peg,
.players-6 .peg,
.players-7 .peg,
.players-8 .peg {
  width: 10px;
  height: 10px;
}

.corner-label {
  position: absolute;
  transform: translate(-50%, -50%);
  width: 28px;
  height: 28px;
  border-radius: 50%;
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 17px;
  font-weight: 700;
  color: #f9fcff;
  background: linear-gradient(150deg, rgba(24, 45, 66, 0.84), rgba(16, 31, 47, 0.78));
  box-shadow: 0 4px 9px rgba(8, 15, 24, 0.35);
  pointer-events: none;
  z-index: 5;
}

.players-4 .corner-label {
  width: 26px;
  height: 26px;
  font-size: 15px;
}

.players-5 .corner-label {
  width: 24px;
  height: 24px;
  font-size: 14px;
}

.players-6 .corner-label,
.players-7 .corner-label,
.players-8 .corner-label {
  width: 22px;
  height: 22px;
  font-size: 12px;
}

.starting-circle {
  position: absolute;
  width: 24px;
  height: 24px;
  transform: translate(-50%, -50%);
  display: flex;
  align-items: center;
  justify-content: center;
  z-index: 8;
}

@media (max-width: 768px) {
  .peg {
    width: 20px;
    height: 20px;
    transform: scale(1.03);
  }

  .peg.selected {
    transform: scale(1.2);
  }

  .peg:active,
  .board-space:active {
    opacity: 0.75;
  }
}
